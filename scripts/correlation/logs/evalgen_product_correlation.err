2025-06-10 17:28:56,955 - INFO - PyTorch version 2.7.0 available.
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/correlation/benchmark_correlation.py", line 270, in <module>
    sys.exit(main())
             ^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/correlation/benchmark_correlation.py", line 186, in main
    from autometrics.metrics.MetricBank import reference_based_metrics, reference_free_metrics, all_metrics
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/MetricBank.py", line 51, in <module>
    BLEU(), CHRF(), TER(), GLEU(), SARI(), BERTScore(), ROUGE(), MOVERScore(), BARTScore(),
            ^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/CHRF.py", line 147, in __init__
    super().__init__(
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/ReferenceBasedMetric.py", line 8, in __init__
    super().__init__(name, description, **kwargs)
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 55, in __init__
    self._cache = Cache(
                  ^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/diskcache/core.py", line 456, in __init__
    sql = self._sql_retry
          ^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/diskcache/core.py", line 652, in _sql_retry
    sql = self._sql
          ^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/diskcache/core.py", line 648, in _sql
    return self._con.execute
           ^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/diskcache/core.py", line 636, in _con
    settings = con.execute(select).fetchall()
               ^^^^^^^^^^^^^^^^^^^
sqlite3.DatabaseError: database disk image is malformed
2025-06-10 17:36:12,420 - INFO - PyTorch version 2.7.0 available.
2025-06-10 17:36:25,949 - INFO - Using default tokenizer.
2025-06-10 17:36:34,217 - INFO - Writing outputs to: outputs/correlation/EvalGenProduct
2025-06-10 17:36:34,217 - INFO - Loading dataset: EvalGenProduct
2025-06-10 17:36:34,362 - INFO - Dataset has no reference columns â€‘ automatically skipping reference-based metrics.
2025-06-10 17:36:34,362 - INFO - Using 17 metrics.
2025-06-10 17:36:34,362 - INFO - Running correlations: pearson, spearman, kendall
Traceback (most recent call last):
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/transformers/modeling_utils.py", line 556, in load_state_dict
    return torch.load(
           ^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/torch/serialization.py", line 1516, in load
    return _load(
           ^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/torch/serialization.py", line 2114, in _load
    result = unpickler.load()
             ^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/torch/_weights_only_unpickler.py", line 532, in load
    self.append(self.persistent_load(pid))
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/torch/serialization.py", line 2078, in persistent_load
    typed_storage = load_tensor(
                    ^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/torch/serialization.py", line 2031, in load_tensor
    zip_file.get_storage_from_record(name, numel, torch.UntypedStorage)
OSError: [Errno 116] Stale file handle

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/transformers/modeling_utils.py", line 565, in load_state_dict
    if f.read(7) == "version":
       ^^^^^^^^^
  File "<frozen codecs>", line 322, in decode
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 64: invalid start byte

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/correlation/benchmark_correlation.py", line 270, in <module>
    sys.exit(main())
             ^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/correlation/benchmark_correlation.py", line 262, in main
    experiment.run(print_results=True)
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/correlation/correlation.py", line 225, in run
    self._ensure_metric_columns(self.val_dataset)
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/correlation/correlation.py", line 105, in _ensure_metric_columns
    metric.predict(dataset, update_dataset=True)
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_free/ReferenceFreeMultiMetric.py", line 49, in predict
    results = self.calculate_batched(inputs, outputs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/MultiMetric.py", line 99, in calculate_batched
    missing_results_by_submetric = self._calculate_batched_impl(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_free/UniEvalFact.py", line 211, in _calculate_batched_impl
    self._load_model()
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_free/UniEvalFact.py", line 173, in _load_model
    self.evaluator = get_evaluator(self.task, device=self.device)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/unieval/evaluator.py", line 290, in get_evaluator
    return FactEvaluator(max_length, device, cache_dir)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/unieval/evaluator.py", line 223, in __init__
    self.scorer = UniEvaluator(
                  ^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/unieval/scorer.py", line 16, in __init__
    self.model = AutoModelForSeq2SeqLM.from_pretrained(model_name_or_path, config=self.config,
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/transformers/models/auto/auto_factory.py", line 571, in from_pretrained
    return model_class.from_pretrained(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/transformers/modeling_utils.py", line 279, in _wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/transformers/modeling_utils.py", line 4399, in from_pretrained
    ) = cls._load_pretrained_model(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/transformers/modeling_utils.py", line 4638, in _load_pretrained_model
    load_state_dict(checkpoint_files[0], map_location="meta", weights_only=weights_only).keys()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/transformers/modeling_utils.py", line 577, in load_state_dict
    raise OSError(
OSError: Unable to load weights from pytorch checkpoint file for '/nlp/scr-sync/nlp/huggingface_hub_llms/hub/models--MingZhong--unieval-fact/snapshots/68e455e999299042881b0cf7f22f45fc7458481f/pytorch_model.bin' at '/nlp/scr-sync/nlp/huggingface_hub_llms/hub/models--MingZhong--unieval-fact/snapshots/68e455e999299042881b0cf7f22f45fc7458481f/pytorch_model.bin'. If you tried to load a PyTorch model from a TF 2.0 checkpoint, please set from_tf=True.
