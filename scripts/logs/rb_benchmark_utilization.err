/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/MOVERScore.py:25: SyntaxWarning: invalid escape sequence '\m'
  """---
/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/BARTScore.py:149: SyntaxWarning: invalid escape sequence '\l'
  """---
/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/BLEURT.py:7: SyntaxWarning: invalid escape sequence '\h'
  """---
/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/LENS.py:7: SyntaxWarning: invalid escape sequence '\m'
  """---
/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_free/Perplexity.py:168: SyntaxWarning: invalid escape sequence '\i'
  """---
/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_free/INFORMRewardModel.py:74: SyntaxWarning: invalid escape sequence '\l'
  """---
/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_free/PRMRewardModel.py:9: SyntaxWarning: invalid escape sequence '\d'
  """---
/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_free/SummaQA.py:117: SyntaxWarning: invalid escape sequence '\{'
  """---
/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_free/FastTextEducationalValue.py:14: SyntaxWarning: invalid escape sequence '\c'
  """---
/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_free/FactCC.py:7: SyntaxWarning: invalid escape sequence '\h'
  """---
/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_free/GRMRewardModel.py:7: SyntaxWarning: invalid escape sequence '\m'
  """---
/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_free/Sentiment.py:8: SyntaxWarning: invalid escape sequence '\h'
  """---
/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_free/LENS_SALSA.py:7: SyntaxWarning: invalid escape sequence '\h'
  """---
[nltk_data] Downloading package words to /sailhome/mryan0/nltk_data...
[nltk_data]   Package words is already up-to-date!
Error in isolated trials: Unexpected error: TER.__init__() got an unexpected keyword argument 'seed'
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/utilization.py", line 1447, in run_isolated_trials
    metric = MetricClass(**constructor_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: TER.__init__() got an unexpected keyword argument 'seed'

Error in isolated trials: Unexpected error: TER.__init__() got an unexpected keyword argument 'seed'
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/utilization.py", line 1447, in run_isolated_trials
    metric = MetricClass(**constructor_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: TER.__init__() got an unexpected keyword argument 'seed'

Error in isolated trials: Unexpected error: TER.__init__() got an unexpected keyword argument 'seed'
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/utilization.py", line 1447, in run_isolated_trials
    metric = MetricClass(**constructor_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: TER.__init__() got an unexpected keyword argument 'seed'

ERROR:__main__:ERROR benchmarking BLEURT: Object of type dtype is not JSON serializable
Error profiling metric autometrics.metrics.reference_based.ParaScore.ParaScore (return code 1)
Stderr: [nltk_data] Downloading package words to /sailhome/mryan0/nltk_data...
[nltk_data]   Package words is already up-to-date!

Error details: Error during first calculation: list index out of range
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/metric_profiler.py", line 248, in _child_main
    metric.calculate(input_text, output_text, references)
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 149, in calculate
    raise e
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 144, in calculate
    result = self._calculate_impl(input, output, references, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/ParaScore.py", line 175, in _calculate_impl
    return P_list[0], P_list[1], P_list[2]
                      ~~~~~~^^^
IndexError: list index out of range

Error in isolated trials: Unexpected error: ParaScorer.__init__() got an unexpected keyword argument 'seed'
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/utilization.py", line 1447, in run_isolated_trials
    metric = MetricClass(**constructor_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/ParaScore.py", line 159, in __init__
    self.scorer = ParaScorer(**scorer_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: ParaScorer.__init__() got an unexpected keyword argument 'seed'

Error in isolated trials: Unexpected error: ParaScorer.__init__() got an unexpected keyword argument 'seed'
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/utilization.py", line 1447, in run_isolated_trials
    metric = MetricClass(**constructor_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/ParaScore.py", line 159, in __init__
    self.scorer = ParaScorer(**scorer_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: ParaScorer.__init__() got an unexpected keyword argument 'seed'

Error in isolated trials: Unexpected error: ParaScorer.__init__() got an unexpected keyword argument 'seed'
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/utilization.py", line 1447, in run_isolated_trials
    metric = MetricClass(**constructor_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/ParaScore.py", line 159, in __init__
    self.scorer = ParaScorer(**scorer_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: ParaScorer.__init__() got an unexpected keyword argument 'seed'

Error profiling metric autometrics.metrics.reference_based.YiSi.YiSi (return code 1)
Stderr: [nltk_data] Downloading package words to /sailhome/mryan0/nltk_data...
[nltk_data]   Package words is already up-to-date!
/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/YiSi.py:62: SyntaxWarning: invalid escape sequence '\i'
  """---

Error details: Error during first calculation: expected scalar type Double but found Float
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/metric_profiler.py", line 248, in _child_main
    metric.calculate(input_text, output_text, references)
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 149, in calculate
    raise e
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 144, in calculate
    result = self._calculate_impl(input, output, references, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/YiSi.py", line 278, in _calculate_impl
    score = self._calculate_batched_impl([input], [output], [refs], **kwargs)[0]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/YiSi.py", line 312, in _calculate_batched_impl
    weighted_pred, weighted_ref = self.model(
                                  ^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/YiSi.py", line 57, in forward
    weighted_pred = self.compute_weighted_pool(max_sim_pred, pred_input_ids)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/YiSi.py", line 41, in compute_weighted_pool
    weighted_sum = torch.bmm(similarities.unsqueeze(1), idf_matrix.unsqueeze(2)).squeeze(-1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: expected scalar type Double but found Float

slurmstepd: error: *** JOB 10360892 ON jagupard39 CANCELLED AT 2025-05-18T02:47:00 ***
[nltk_data] Downloading package words to /sailhome/mryan0/nltk_data...
[nltk_data]   Package words is already up-to-date!
Timeout running isolated trials for autometrics.metrics.reference_based.TER.TER category medium
Timeout running isolated trials for autometrics.metrics.reference_based.TER.TER category long
Error in isolated trials: Error during burn-in: The size of tensor a (560) must match the size of tensor b (512) at non-singleton dimension 1
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/utilization.py", line 1484, in run_isolated_trials
    metric.calculate(input_text, output_text, reference_texts)
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 149, in calculate
    raise e
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 144, in calculate
    result = self._calculate_impl(input, output, references, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/BLEURT.py", line 214, in _calculate_impl
    logits = self.model(**inputs).logits.flatten()
             ^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/bleurt_pytorch/bleurt/modeling_bleurt.py", line 841, in forward
    outputs = self.bleurt(
              ^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/bleurt_pytorch/bleurt/modeling_bleurt.py", line 687, in forward
    embedding_output = self.embeddings(
                       ^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/bleurt_pytorch/bleurt/modeling_bleurt.py", line 111, in forward
    embeddings += position_embeddings
RuntimeError: The size of tensor a (560) must match the size of tensor b (512) at non-singleton dimension 1

Error profiling metric autometrics.metrics.reference_based.ParaScore.ParaScore (return code 1)
Stderr: [nltk_data] Downloading package words to /sailhome/mryan0/nltk_data...
[nltk_data]   Package words is already up-to-date!

Error details: Error during first calculation: list index out of range
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/metric_profiler.py", line 248, in _child_main
    metric.calculate(input_text, output_text, references)
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 149, in calculate
    raise e
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 144, in calculate
    result = self._calculate_impl(input, output, references, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/ParaScore.py", line 175, in _calculate_impl
    return P_list[0], P_list[1], P_list[2]
                      ~~~~~~^^^
IndexError: list index out of range

Error in isolated trials: Unexpected error: ParaScorer.__init__() got an unexpected keyword argument 'seed'
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/utilization.py", line 1447, in run_isolated_trials
    metric = MetricClass(**constructor_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/ParaScore.py", line 159, in __init__
    self.scorer = ParaScorer(**scorer_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: ParaScorer.__init__() got an unexpected keyword argument 'seed'

Error in isolated trials: Unexpected error: ParaScorer.__init__() got an unexpected keyword argument 'seed'
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/utilization.py", line 1447, in run_isolated_trials
    metric = MetricClass(**constructor_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/ParaScore.py", line 159, in __init__
    self.scorer = ParaScorer(**scorer_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: ParaScorer.__init__() got an unexpected keyword argument 'seed'

Error in isolated trials: Unexpected error: ParaScorer.__init__() got an unexpected keyword argument 'seed'
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/utilization.py", line 1447, in run_isolated_trials
    metric = MetricClass(**constructor_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/ParaScore.py", line 159, in __init__
    self.scorer = ParaScorer(**scorer_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: ParaScorer.__init__() got an unexpected keyword argument 'seed'

Error profiling metric autometrics.metrics.reference_based.YiSi.YiSi (return code 1)
Stderr: [nltk_data] Downloading package words to /sailhome/mryan0/nltk_data...
[nltk_data]   Package words is already up-to-date!

Error details: Error during first calculation: expected scalar type Double but found Float
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/metric_profiler.py", line 248, in _child_main
    metric.calculate(input_text, output_text, references)
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 149, in calculate
    raise e
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 144, in calculate
    result = self._calculate_impl(input, output, references, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/YiSi.py", line 278, in _calculate_impl
    score = self._calculate_batched_impl([input], [output], [refs], **kwargs)[0]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/YiSi.py", line 312, in _calculate_batched_impl
    weighted_pred, weighted_ref = self.model(
                                  ^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/YiSi.py", line 57, in forward
    weighted_pred = self.compute_weighted_pool(max_sim_pred, pred_input_ids)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/YiSi.py", line 41, in compute_weighted_pool
    weighted_sum = torch.bmm(similarities.unsqueeze(1), idf_matrix.unsqueeze(2)).squeeze(-1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: expected scalar type Double but found Float

Error in isolated trials: Error during burn-in: expected scalar type Double but found Float
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/utilization.py", line 1484, in run_isolated_trials
    metric.calculate(input_text, output_text, reference_texts)
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 149, in calculate
    raise e
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 144, in calculate
    result = self._calculate_impl(input, output, references, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/YiSi.py", line 278, in _calculate_impl
    score = self._calculate_batched_impl([input], [output], [refs], **kwargs)[0]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/YiSi.py", line 312, in _calculate_batched_impl
    weighted_pred, weighted_ref = self.model(
                                  ^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/YiSi.py", line 57, in forward
    weighted_pred = self.compute_weighted_pool(max_sim_pred, pred_input_ids)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/YiSi.py", line 41, in compute_weighted_pool
    weighted_sum = torch.bmm(similarities.unsqueeze(1), idf_matrix.unsqueeze(2)).squeeze(-1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: expected scalar type Double but found Float

Error in isolated trials: Error during burn-in: expected scalar type Double but found Float
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/utilization.py", line 1484, in run_isolated_trials
    metric.calculate(input_text, output_text, reference_texts)
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 149, in calculate
    raise e
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 144, in calculate
    result = self._calculate_impl(input, output, references, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/YiSi.py", line 278, in _calculate_impl
    score = self._calculate_batched_impl([input], [output], [refs], **kwargs)[0]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/YiSi.py", line 312, in _calculate_batched_impl
    weighted_pred, weighted_ref = self.model(
                                  ^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/YiSi.py", line 57, in forward
    weighted_pred = self.compute_weighted_pool(max_sim_pred, pred_input_ids)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/YiSi.py", line 41, in compute_weighted_pool
    weighted_sum = torch.bmm(similarities.unsqueeze(1), idf_matrix.unsqueeze(2)).squeeze(-1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: expected scalar type Double but found Float

Error in isolated trials: Error during burn-in: expected scalar type Double but found Float
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/utilization.py", line 1484, in run_isolated_trials
    metric.calculate(input_text, output_text, reference_texts)
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 149, in calculate
    raise e
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 144, in calculate
    result = self._calculate_impl(input, output, references, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/YiSi.py", line 278, in _calculate_impl
    score = self._calculate_batched_impl([input], [output], [refs], **kwargs)[0]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/YiSi.py", line 312, in _calculate_batched_impl
    weighted_pred, weighted_ref = self.model(
                                  ^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/YiSi.py", line 57, in forward
    weighted_pred = self.compute_weighted_pool(max_sim_pred, pred_input_ids)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/YiSi.py", line 41, in compute_weighted_pool
    weighted_sum = torch.bmm(similarities.unsqueeze(1), idf_matrix.unsqueeze(2)).squeeze(-1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: expected scalar type Double but found Float

Error profiling metric autometrics.metrics.reference_based.MAUVE.MAUVE (return code 1)
Stderr: [nltk_data] Downloading package words to /sailhome/mryan0/nltk_data...
[nltk_data]   Package words is already up-to-date!

Downloading builder script:   0%|          | 0.00/7.24k [00:00<?, ?B/s]
Downloading builder script: 100%|██████████| 7.24k/7.24k [00:00<00:00, 52.7MB/s]

Error details: Error during first calculation: Predictions and/or references don't match the expected format.
Expected format: {'predictions': Value(dtype='string', id='sequence'), 'references': Value(dtype='string', id='sequence')},
Input predictions: ['case year point woman person time year man world week government time case man group.'],
Input references: [['company group case woman world place point life time fact.', 'thing group woman part life day man fact part way year eye way child.']]
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/metric_profiler.py", line 248, in _child_main
    metric.calculate(input_text, output_text, references)
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 149, in calculate
    raise e
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 144, in calculate
    result = self._calculate_impl(input, output, references, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/MAUVE.py", line 179, in _calculate_impl
    return super()._calculate_impl(input, output, references, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/HuggingFaceReferenceBasedMetric.py", line 40, in _calculate_impl
    result = self.metric.compute(predictions=[output], references=[refs], **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/evaluate/module.py", line 455, in compute
    self.add_batch(**inputs)
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/evaluate/module.py", line 546, in add_batch
    raise ValueError(error_msg) from None
ValueError: Predictions and/or references don't match the expected format.
Expected format: {'predictions': Value(dtype='string', id='sequence'), 'references': Value(dtype='string', id='sequence')},
Input predictions: ['case year point woman person time year man world week government time case man group.'],
Input references: [['company group case woman world place point life time fact.', 'thing group woman part life day man fact part way year eye way child.']]

Error in isolated trials: Unexpected error: autometrics.metrics.reference_based.HuggingFaceReferenceBasedMetric.HuggingFaceReferenceBasedMetric.__init__() got multiple values for keyword argument 'metric_id'
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/utilization.py", line 1447, in run_isolated_trials
    metric = MetricClass(**constructor_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/MAUVE.py", line 164, in __init__
    super().__init__(
TypeError: autometrics.metrics.reference_based.HuggingFaceReferenceBasedMetric.HuggingFaceReferenceBasedMetric.__init__() got multiple values for keyword argument 'metric_id'

Error in isolated trials: Unexpected error: autometrics.metrics.reference_based.HuggingFaceReferenceBasedMetric.HuggingFaceReferenceBasedMetric.__init__() got multiple values for keyword argument 'metric_id'
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/utilization.py", line 1447, in run_isolated_trials
    metric = MetricClass(**constructor_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/MAUVE.py", line 164, in __init__
    super().__init__(
TypeError: autometrics.metrics.reference_based.HuggingFaceReferenceBasedMetric.HuggingFaceReferenceBasedMetric.__init__() got multiple values for keyword argument 'metric_id'

Error in isolated trials: Unexpected error: autometrics.metrics.reference_based.HuggingFaceReferenceBasedMetric.HuggingFaceReferenceBasedMetric.__init__() got multiple values for keyword argument 'metric_id'
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/utilization.py", line 1447, in run_isolated_trials
    metric = MetricClass(**constructor_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/MAUVE.py", line 164, in __init__
    super().__init__(
TypeError: autometrics.metrics.reference_based.HuggingFaceReferenceBasedMetric.HuggingFaceReferenceBasedMetric.__init__() got multiple values for keyword argument 'metric_id'

Error profiling metric autometrics.metrics.reference_based.CharCut.CharCut (return code 1)
Stderr: [nltk_data] Downloading package words to /sailhome/mryan0/nltk_data...
[nltk_data]   Package words is already up-to-date!

Error details: Error during first calculation: Couldn't find a module script at /juice2/scr2/nlp/personal-rm/autometrics/charcut/charcut.py. Module 'charcut' doesn't exist on the Hugging Face Hub either.
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/metric_profiler.py", line 248, in _child_main
    metric.calculate(input_text, output_text, references)
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 149, in calculate
    raise e
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 144, in calculate
    result = self._calculate_impl(input, output, references, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/HuggingFaceReferenceBasedMetric.py", line 37, in _calculate_impl
    self._load_metric()
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/HuggingFaceReferenceBasedMetric.py", line 34, in _load_metric
    self.metric = load(self.metric_id, **self.load_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/evaluate/loading.py", line 748, in load
    evaluation_module = evaluation_module_factory(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/evaluate/loading.py", line 681, in evaluation_module_factory
    raise FileNotFoundError(
FileNotFoundError: Couldn't find a module script at /juice2/scr2/nlp/personal-rm/autometrics/charcut/charcut.py. Module 'charcut' doesn't exist on the Hugging Face Hub either.

Error in isolated trials: Error during burn-in: Couldn't find a module script at /juice2/scr2/nlp/personal-rm/autometrics/charcut/charcut.py. Module 'charcut' doesn't exist on the Hugging Face Hub either.
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/utilization.py", line 1484, in run_isolated_trials
    metric.calculate(input_text, output_text, reference_texts)
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 149, in calculate
    raise e
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 144, in calculate
    result = self._calculate_impl(input, output, references, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/HuggingFaceReferenceBasedMetric.py", line 37, in _calculate_impl
    self._load_metric()
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/HuggingFaceReferenceBasedMetric.py", line 34, in _load_metric
    self.metric = load(self.metric_id, **self.load_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/evaluate/loading.py", line 748, in load
    evaluation_module = evaluation_module_factory(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/evaluate/loading.py", line 681, in evaluation_module_factory
    raise FileNotFoundError(
FileNotFoundError: Couldn't find a module script at /juice2/scr2/nlp/personal-rm/autometrics/charcut/charcut.py. Module 'charcut' doesn't exist on the Hugging Face Hub either.

Error in isolated trials: Error during burn-in: Couldn't find a module script at /juice2/scr2/nlp/personal-rm/autometrics/charcut/charcut.py. Module 'charcut' doesn't exist on the Hugging Face Hub either.
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/utilization.py", line 1484, in run_isolated_trials
    metric.calculate(input_text, output_text, reference_texts)
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 149, in calculate
    raise e
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 144, in calculate
    result = self._calculate_impl(input, output, references, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/HuggingFaceReferenceBasedMetric.py", line 37, in _calculate_impl
    self._load_metric()
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/HuggingFaceReferenceBasedMetric.py", line 34, in _load_metric
    self.metric = load(self.metric_id, **self.load_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/evaluate/loading.py", line 748, in load
    evaluation_module = evaluation_module_factory(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/evaluate/loading.py", line 681, in evaluation_module_factory
    raise FileNotFoundError(
FileNotFoundError: Couldn't find a module script at /juice2/scr2/nlp/personal-rm/autometrics/charcut/charcut.py. Module 'charcut' doesn't exist on the Hugging Face Hub either.

Error in isolated trials: Error during burn-in: Couldn't find a module script at /juice2/scr2/nlp/personal-rm/autometrics/charcut/charcut.py. Module 'charcut' doesn't exist on the Hugging Face Hub either.
Traceback:
Traceback (most recent call last):
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/experiments/utilization/utilization.py", line 1484, in run_isolated_trials
    metric.calculate(input_text, output_text, reference_texts)
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 149, in calculate
    raise e
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/Metric.py", line 144, in calculate
    result = self._calculate_impl(input, output, references, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/HuggingFaceReferenceBasedMetric.py", line 37, in _calculate_impl
    self._load_metric()
  File "/juice2/scr2/nlp/personal-rm/autometrics/autometrics/metrics/reference_based/HuggingFaceReferenceBasedMetric.py", line 34, in _load_metric
    self.metric = load(self.metric_id, **self.load_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/evaluate/loading.py", line 748, in load
    evaluation_module = evaluation_module_factory(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nlp/scr/mryan0/miniconda3/envs/autometrics/lib/python3.12/site-packages/evaluate/loading.py", line 681, in evaluation_module_factory
    raise FileNotFoundError(
FileNotFoundError: Couldn't find a module script at /juice2/scr2/nlp/personal-rm/autometrics/charcut/charcut.py. Module 'charcut' doesn't exist on the Hugging Face Hub either.

